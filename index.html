<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <title>Diferencial de Alíquotas RJ</title>
    <meta charset="utf-8" />
    <link rel="shortcut icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSimiQ69vg4NT2ajbZgLpBJXCn0b2d5rX3RuA&s" type="image/x-icon" />
    <link
      href="css/estilo.css"
      type="text/css"
      rel="stylesheet"
      media="screen"
    />
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/script.js"></script>
  </head>

  <body>
    <header>
        <img src="https://jnmoura.com.br/pt-br/JNMouraPretaHorizontal.png" id="banner">
    </header>
    <section id="corpo">
      <form method="post" name="form1" action="diferencial_pr.php">
        <table id="dados_calculadora">
          <tr>
            <td colspan="3" class="facil_tit">
              <span>Diferencial de Alíquotas - RJ</span>
            </td>            
          </tr>
          <tr>
            <td colspan="4" class="facil_subtit">
              <span>Dados para o Cálculo: </span>
            </td>
          </tr>
          <tr>
            <td class="titulo_input"><span>Estado Origem:</span></td>
            <td class="facil_select">
              <select
                class="select"
                id="estados"
                style="background: #fff"
                name="estados"
              >
                <option value="">Selecione...</option>
                <option value="1">Acre</option>
                <option value="2">Alagoas</option>
                <option value="3">Amazonas</option>
                <option value="4">Amapá</option>
                <option value="5">Bahia</option>
                <option value="6">Ceará</option>
                <option value="7">Distrito Federal</option>
                <option value="8">Espírito Santo</option>
                <option value="9">Goiás</option>
                <option value="10">Maranhão</option>
                <option value="11">Mato Grosso</option>
                <option value="12">Mato Grosso do Sul</option>
                <option value="13">Minas Gerais</option>
                <option value="14">Pará</option>
                <option value="15">Paraíba</option>
                <option value="16">Paraná</option>
                <option value="17">Pernambuco</option>
                <option value="18">Piauí</option>
                <option value="19">Rio Grande do Norte</option>
                <option value="20">Rio Grande do Sul</option>
                <option value="21" disabled>Rio de Janeiro</option>
                <option value="22">Rondônia</option>
                <option value="23">Roraima</option>
                <option value="24">Santa Catarina</option>
                <option value="25">São Paulo</option>
                <option value="26">Sergipe</option>
                <option value="27">Tocantins</option>
              </select>
            </td>
          </tr>
          <tr>
            <td class="titulo_input"><span>Destinação da Mercadoria:</span></td>
            <td class="facil_input">
              <select
                class="select"
                id="destinacao"
                name="destinacao"
                onclick="esconder()"
              >
                <option selected="selected" value="">Selecione</option>
                <option value="1" disabled>Comercialização</option>
                <option value="2" disabled>Matéria Prima</option>
                <option value="3">Consumo/Ativo</option>
              </select>
            </td>
            <td class="titulo_input">
              <span>Mercadoria é tributada 4% ?</span>
            </td>
            <td class="facil_input">
              <select class="select" id="origem" name="origem">
                <option selected="selected" value="">Selecione</option>
                <option value="1">Sim</option>
                <option value="2">Não</option>
              </select>
            </td>
          </tr>
        </table>
        <table id="valores_diferenca">
          <tr>
            <td colspan="4" class="facil_subtit">
              <span>Valores para o Cálculo:</span>
            </td>
          </tr>
          <tr>
            <td class="titulo_input"><span>Valor da Operação NF:</span></td>
            <td class="facil_input">
              <input
                class="input"
                onkeyup="mascara(this, mvalor);"
                type="text"
                placeholder="R$ 00,00"
                id="base_d"
                autocomplete="on"
                name="base_d"
              />
            </td>
          </tr>
          <tr>
            <td class="titulo_input">
              <span>Alíquota Interna Destino(%):</span>
            </td>
            <td class="facil_input">
              <select class="select" id="destino_d" name="destino_d">
                <option selected="selected" value="">Selecione</option>
                <option value="11">6</option>
                <option value="10">7</option>
                <option value="9">12</option>
                <option value="8">16</option>
                <option value="7">18</option>
                <option value="20">20</option>
                <option value="6">27</option>
                <option value="5">28</option>
                <option value="4">30</option>
                <option value="3">32</option>
                <option value="2">37</option>
              </select>
            </td>
            <td class="titulo_input">
              <span>Fundo de Pobreza Destino(%):</span>
            </td>
            <td class="facil_input">
              <input
                class="input"
                id="fcp_d"
                type="text"
                onkeyup="mascara(this, mvalor);"
                placeholder="00.00%"
                autocomplete="on"
                name="fcp_d"
              />
            </td>
          </tr>
          <tr>
            <td class="facil_input" colspan="4">
              <input
                class="botaofil"
                type="button"
                onclick="calcular_diferenca()"
                value="Calcular"
              />
            </td>
          </tr>
        </table>
        <div id="resultado">
          <table>
            <tr>
              <td colspan="4" class="facil_subtit">
                <span>Dados Informados: </span>
              </td>
            </tr>
            <tr class="dados_titulo">
              <td><span>Estado de Origem </span></td>
              <td><span>Estado de Destino </span></td>
              <td><span>Alíquota interestadual (%) </span></td>
              <td><span>Alíquota Interna (%) </span></td>
            </tr>
            <tr class="dados_resul">
              <td>
                <span
                  ><input
                    id="estados_i"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
              <td><span>RJ</span></td>
              <td>
                <span
                  ><input
                    id="aliqinter_i"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
              <td>
                <span
                  ><input
                    id="aliqdest_i"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
            </tr>
            <tr class="dados_titulo">
              <td><span>Aliq. FCP (%) </span></td>
              <td colspan="2">
                <span>Base de Cálculo Diferencial (R$) </span>
              </td>
              <td>
                <span> ICMS UF Origem</span>

            </td>
            </tr>
            <tr class="dados_resul">
              <td>
                <span
                  ><input
                    id="aliqfcp_i"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
              <td colspan="2">
                <span
                  ><input
                    id="base_i"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
              <td>
                <span
                  ><input
                    id="IcmsOrigem"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
            </tr>
            <tr>
              <td colspan="4" class="facil_subtit">
                <span>Imposto Apurado: </span>
              </td>
            </tr>
            <tr class="dados_titulo">
              <td><span>Diferencial de Alíquotas (R$) </span></td>
              <td><span>Fundo de Pobreza (R$) </span></td>
              <td colspan="2"><span>Total a Recolher (R$) </span></td>
            </tr>
            <tr class="dados_resul">
              <td>
                <span
                  ><input
                    id="diferencial_i"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
              <td>
                <span
                  ><input
                    id="fcprecolher_i"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
              <td colspan="2">
                <span
                  ><input
                    id="total_i"
                    disabled="disabled"
                    class="input_resul"
                    type="text"
                /></span>
              </td>
            </tr>
          </table>
        </div>
      </form>
    </section>
    <script>
      // mascara de moeda

      function mascara(o, f) {
        v_obj = o;
        v_fun = f;
        setTimeout("execmascara()", 1);
      }
      function execmascara() {
        v_obj.value = v_fun(v_obj.value);
      }
      function mvalor(v) {
        v = v.replace(/\D/g, ""); //Remove tudo o que não é dígito
        v = v.replace(/(\d)(\d{2})$/, "$1.$2"); //coloca a virgula antes dos 2 últimos dígitos
        return v;
      }
      //Esconder e Aparecer calculadora
      function esconder() {
        if (document.form1.destinacao.value == 1) {
          $("#valores_antecipa").show();
          $("#valores_diferenca").hide();
          $("#resultado").hide();
        }
        if (document.form1.destinacao.value == 2) {
          $("#valores_antecipa").show();
          $("#valores_diferenca").hide();
          $("#resultado").hide();
        }
        if (document.form1.destinacao.value == 3) {
          $("#valores_diferenca").show();
          $("#valores_antecipa").hide();
          $("#resultado").hide();
        }
      }

      function calcular_diferenca() {
        //Avisos

        if (
          (document.getElementById("destinacao").value == 2 &&
            document.getElementById("origem").value == 2) ||
          (document.getElementById("destinacao").value == 1 &&
            document.getElementById("origem").value == 2)
        ) {
          $("#aviso_1").show();
          $("#resultado").hide();
        } else {
          $("#aviso_1").hide();
          $("#resultado").show();
        }

        //Bloquear ação com campos em branco

        if (document.getElementById("estados").value == "") {
          alert("Estado de origem não selecionado");
          $("#resultado").hide();
          callback();
        }
        if (document.getElementById("destinacao").value == "") {
          alert("Destinação da Mercadoria não selecionada");
          $("#resultado").hide();
          callback();
        }
        if (document.getElementById("origem").value == "") {
          alert("Informe se a mercadoria é tributada a 4%");
          $("#resultado").hide();
          callback();
        }
        if (document.getElementById("destino_d").value == "") {
          alert("Selecione a alíquota interna na UF de destino");
          $("#resultado").hide();
          callback();
        }
        if (document.getElementById("base_d").value == "") {
          alert("Informe o valor da operação da NF");
          $("#resultado").hide();
          callback();
        }

        //Definir aliquota interestadual
        //Nacional
        //1-sim ou 2-nao
        if (document.getElementById("origem").value == 2) {
          var aliqinter_d = 12;
        }
        //Importado
        if (document.getElementById("origem").value == 1) {
          var aliqinter_d = 4;
        }

        //Definir aliquota interna

        if (document.getElementById("destino_d").value == 2) {
          var aliqdest_d = 37;
        }
        if (document.getElementById("destino_d").value == 3) {
          var aliqdest_d = 32;
        }
        if (document.getElementById("destino_d").value == 4) {
          var aliqdest_d = 30;
        }
        if (document.getElementById("destino_d").value == 5) {
          var aliqdest_d = 28;
        }
        if (document.getElementById("destino_d").value == 6) {
          var aliqdest_d = 27;
        }
        if (document.getElementById("destino_d").value == 20) {
          var aliqdest_d = 20;
        }
        if (document.getElementById("destino_d").value == 7) {
          var aliqdest_d = 18;
        }
        if (document.getElementById("destino_d").value == 8) {
          var aliqdest_d = 16;
        }
        if (document.getElementById("destino_d").value == 9) {
          var aliqdest_d = 12;
        }
        if (document.getElementById("destino_d").value == 10) {
          var aliqdest_d = 7;
        }
        if (document.getElementById("destino_d").value == 11) {
          var aliqdest_d = 6;
        }

        //Definir Aliquota FCP

        var aliqfcp_d = document.getElementById("fcp_d").value * 1;

        //Definir Base de Cálculo

        var base_d =
          (document.getElementById("base_d").value * 1) /
          (1 - (aliqdest_d + aliqfcp_d) / 100);

        //Definir estados
        if (document.getElementById("estados").value == 1) {
          var estado_rem = "AC";
        }
        if (document.getElementById("estados").value == 2) {
          var estado_rem = "AL";
        }
        if (document.getElementById("estados").value == 3) {
          var estado_rem = "AM";
        }
        if (document.getElementById("estados").value == 4) {
          var estado_rem = "AP";
        }
        if (document.getElementById("estados").value == 5) {
          var estado_rem = "BA";
        }
        if (document.getElementById("estados").value == 6) {
          var estado_rem = "CE";
        }
        if (document.getElementById("estados").value == 7) {
          var estado_rem = "DF";
        }
        if (document.getElementById("estados").value == 8) {
          var estado_rem = "ES";
        }
        if (document.getElementById("estados").value == 9) {
          var estado_rem = "GO";
        }
        if (document.getElementById("estados").value == 10) {
          var estado_rem = "MA";
        }
        if (document.getElementById("estados").value == 11) {
          var estado_rem = "MT";
        }
        if (document.getElementById("estados").value == 12) {
          var estado_rem = "MS";
        }
        if (document.getElementById("estados").value == 13) {
          var estado_rem = "MG";
        }
        if (document.getElementById("estados").value == 14) {
          var estado_rem = "PA";
        }
        if (document.getElementById("estados").value == 15) {
          var estado_rem = "PB";
        }
        if (document.getElementById("estados").value == 16) {
          var estado_rem = "PR";
        }
        if (document.getElementById("estados").value == 17) {
          var estado_rem = "PE";
        }
        if (document.getElementById("estados").value == 18) {
          var estado_rem = "PI";
        }
        if (document.getElementById("estados").value == 19) {
          var estado_rem = "RN";
        }
        if (document.getElementById("estados").value == 20) {
          var estado_rem = "RS";
        }
        if (document.getElementById("estados").value == 21) {
          var estado_rem = "RJ";
        }
        if (document.getElementById("estados").value == 22) {
          var estado_rem = "RO";
        }
        if (document.getElementById("estados").value == 23) {
          var estado_rem = "RR";
        }
        if (document.getElementById("estados").value == 24) {
          var estado_rem = "SC";
        }
        if (document.getElementById("estados").value == 25) {
          var estado_rem = "SP";
        }
        if (document.getElementById("estados").value == 26) {
          var estado_rem = "SE";
        }
        if (document.getElementById("estados").value == 27) {
          var estado_rem = "TO";
        }

        //Calcular Diferencial

        //Calcular FCP
        var fcprecolher = base_d * (aliqfcp_d / 100);

        //Diferencial Resultado
        var diferencial = base_d * ((aliqdest_d - aliqinter_d) / 100);
        if (diferencial < 0) {
          var diferencial = 0;
        } else {
          var diferencial = base_d * ((aliqdest_d - aliqinter_d) / 100);
        }

        // Icms UF Origem
        var icmsOrigem = base_d * (aliqinter_d/100)

        //Total Diferencial
        var total = fcprecolher + diferencial;

        //Imprimir
        document.getElementById("aliqinter_i").value = aliqinter_d.toString();
        document.getElementById("aliqdest_i").value = aliqdest_d.toString();
        document.getElementById("estados_i").value = estado_rem.toString();
        document.getElementById("aliqfcp_i").value = aliqfcp_d.toString();
        document.getElementById("diferencial_i").value = diferencial.toFixed(2);
        document.getElementById("base_i").value = base_d.toFixed(2);
        document.getElementById("fcprecolher_i").value = fcprecolher.toFixed(2);
        document.getElementById("total_i").value = total.toFixed(2);
        document.getElementById("IcmsOrigem").value = icmsOrigem.toFixed(2);
      }
    </script>
    <footer></footer>
  </body>
</html>
